# Python API è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº Python + pytest + allure çš„ API è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼Œæ”¯æŒæ•°æ®é©±åŠ¨æµ‹è¯•ã€æµ‹è¯•æŠ¥å‘Šç”Ÿæˆã€é‚®ä»¶é€šçŸ¥ã€é’‰é’‰é€šçŸ¥ç­‰åŠŸèƒ½ã€‚

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
Python-api-test/
â”œâ”€â”€ commons/               # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ all_requests.py   # HTTPè¯·æ±‚å°è£…
â”‚   â”œâ”€â”€ assert_cases.py   # æ–­è¨€å¤„ç†
â”‚   â”œâ”€â”€ cases.py          # ç”¨ä¾‹æ‰§è¡Œé€»è¾‘
â”‚   â”œâ”€â”€ hot_loads.py      # çƒ­åŠ è½½åŠŸèƒ½
â”‚   â”œâ”€â”€ module.py         # æ¨¡å—ç®¡ç†
â”‚   â”œâ”€â”€ replace_template.py # æ¨¡æ¿æ›¿æ¢
â”‚   â””â”€â”€ save_extract.py   # æ•°æ®æå–ä¿å­˜
â”œâ”€â”€ config/               # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.yaml       # ä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ email_template.html # é‚®ä»¶æ¨¡æ¿
â”œâ”€â”€ datas/                # æµ‹è¯•æ•°æ®
â”‚   â””â”€â”€ Auth/            # è®¤è¯ç›¸å…³æ•°æ®
â”œâ”€â”€ outputs/              # è¾“å‡ºæ–‡ä»¶
â”‚   â”œâ”€â”€ log/             # æ—¥å¿—æ–‡ä»¶
â”‚   â”œâ”€â”€ reports/         # æµ‹è¯•æŠ¥å‘Š
â”‚   â””â”€â”€ temps/           # ä¸´æ—¶æ–‡ä»¶
â”œâ”€â”€ testcases/           # æµ‹è¯•ç”¨ä¾‹
â”‚   â””â”€â”€ test_api_funcs.py # APIåŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ clear_old_files.py # æ–‡ä»¶æ¸…ç†
â”‚   â”œâ”€â”€ copy_data.py      # æ•°æ®å¤åˆ¶
â”‚   â”œâ”€â”€ generate_report.py # æŠ¥å‘Šç”Ÿæˆ
â”‚   â”œâ”€â”€ mock_api.py       # Mock API
â”‚   â”œâ”€â”€ notification_utils.py # é€šçŸ¥å·¥å…·
â”‚   â”œâ”€â”€ send_email_utils.py # é‚®ä»¶å‘é€
â”‚   â”œâ”€â”€ user_auth.py      # ç”¨æˆ·è®¤è¯
â”‚   â””â”€â”€ yaml_handle.py    # YAMLå¤„ç†
â”œâ”€â”€ conftest.py          # pytesté…ç½®
â”œâ”€â”€ pytest.ini           # pytestè®¾ç½®
â”œâ”€â”€ requirements.txt     # ä¾èµ–ç®¡ç†
â””â”€â”€ run.py              # å¯åŠ¨å…¥å£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

1. **Pythonç¯å¢ƒ**ï¼šç¡®ä¿å®‰è£…äº† Python 3.7+
2. **å®‰è£…ä¾èµ–**ï¼š
   ```bash
   pip install -r requirements.txt
   ```

### é…ç½®è®¾ç½®

1. **ä¿®æ”¹é…ç½®æ–‡ä»¶**ï¼šç¼–è¾‘ `config/config.yaml`
   - è®¾ç½®æµ‹è¯•ç¯å¢ƒURL
   - é…ç½®é‚®ä»¶é€šçŸ¥ï¼ˆå¯é€‰ï¼‰
   - é…ç½®é’‰é’‰é€šçŸ¥ï¼ˆå¯é€‰ï¼‰
   - é…ç½®æ•°æ®åº“è¿æ¥ï¼ˆå¦‚éœ€è¦ï¼‰

2. **å‡†å¤‡æµ‹è¯•æ•°æ®**ï¼šåœ¨ `datas/` ç›®å½•ä¸‹å‡†å¤‡æµ‹è¯•ç”¨ä¾‹çš„ YAML æ–‡ä»¶

### è¿è¡Œæµ‹è¯•

1. **æ‰§è¡Œæ‰€æœ‰æµ‹è¯•**ï¼š
   ```bash
   python run.py
   ```

2. **æ‰§è¡Œç‰¹å®šæµ‹è¯•**ï¼š
   ```bash
   pytest testcases/test_api_funcs.py -v
   ```

3. **ç”Ÿæˆ Allure æŠ¥å‘Š**ï¼š
   ```bash
   allure serve outputs/temps/allure_results
   ```

## ğŸ“Š åŠŸèƒ½ç‰¹æ€§

- âœ… **æ•°æ®é©±åŠ¨æµ‹è¯•**ï¼šæ”¯æŒ YAML æ ¼å¼çš„æµ‹è¯•æ•°æ®
- âœ… **è‡ªåŠ¨åŒ–æŠ¥å‘Š**ï¼šé›†æˆ Allure æµ‹è¯•æŠ¥å‘Š
- âœ… **å¤šç§é€šçŸ¥æ–¹å¼**ï¼šæ”¯æŒé‚®ä»¶å’Œé’‰é’‰é€šçŸ¥
- âœ… **æ—¥å¿—è®°å½•**ï¼šè¯¦ç»†çš„æµ‹è¯•æ‰§è¡Œæ—¥å¿—
- âœ… **æ•°æ®æå–**ï¼šæ”¯æŒå“åº”æ•°æ®æå–å’Œå‚æ•°åŒ–
- âœ… **æ–­è¨€éªŒè¯**ï¼šå¤šç§æ–­è¨€æ–¹å¼
- âœ… **ç¯å¢ƒç®¡ç†**ï¼šæ”¯æŒå¤šç¯å¢ƒé…ç½®

## ğŸ”§ é…ç½®è¯´æ˜

### config.yaml ä¸»è¦é…ç½®é¡¹

```yaml
# åŸºç¡€é…ç½®
BaseConfig:
  test_email: 'æµ‹è¯•é‚®ç®±'

# æµ‹è¯•æŠ¥å‘Š
REPORT:
  title: 'æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•æŠ¥å‘Š'

# é¡¹ç›®ç¯å¢ƒ
ENV:
  test_url: 'æµ‹è¯•ç¯å¢ƒURL'

# é‚®ç®±é…ç½®
SMTP:
  switch: False  # æ˜¯å¦å¼€å¯é‚®ä»¶é€šçŸ¥
  smtp_server: smtp.qq.com
  # ... å…¶ä»–é‚®ä»¶é…ç½®

# é’‰é’‰é€šçŸ¥é…ç½®
DingTalk_RobotNotice:
  switch: False  # æ˜¯å¦å¼€å¯é’‰é’‰é€šçŸ¥
  # ... å…¶ä»–é’‰é’‰é…ç½®
```

## ğŸ“ æµ‹è¯•ç”¨ä¾‹ç¼–å†™

æµ‹è¯•ç”¨ä¾‹ä½¿ç”¨ YAML æ ¼å¼ç¼–å†™ï¼Œç¤ºä¾‹ï¼š

```yaml
- case_info:
    case_name: "è·å–ç”¨æˆ·ä¿¡æ¯"
    url: "/api/user/info"
    method: "GET"
    headers:
      Authorization: "Bearer ${auth_token}"
    expected:
      status_code: 200
      json_path:
        $.code: 0
        $.message: "success"
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä½¿ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚ 